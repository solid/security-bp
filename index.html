<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>Solid Security Considerations</title>
  <meta content="CG-DRAFT" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/cg-draft" rel="stylesheet">
  <meta content="Bikeshed version a1dabb26c, updated Mon Jun 17 15:00:44 2024 -0700" name="generator">
  <link href="https://solid.github.io/security-considerations/" rel="canonical">
  <meta content="2c9c30fda26aeea164b3021aaeea12a517cab31b" name="revision">
  <meta content="dark light" name="color-scheme">
  <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css">
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */
/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-selflinks */
:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Solid Security Considerations</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#CG-DRAFT">Draft Community Group Report</a>, <time class="dt-updated" datetime="2024-06-22">22 June 2024</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://solid.github.io/security-considerations/">https://solid.github.io/security-considerations/</a>
      <dt>Editor's Draft:
      <dd><a href="https://solid.github.io/security-considerations/">https://solid.github.io/security-considerations/</a>
      <dt>Created:
      <dd>Feb 20, 2024
      <dt>Modified:
      <dd>22 June 2024
      <dt>Issue Tracking:
      <dd><a href="https://github.com/solid/security-considerations/issues/">GitHub</a>
      <dt class="editor">Editor:
      <dd class="editor p-author h-card vcard"><span class="p-name fn"><a href="https://elf-pavlik.hackers4peace.net/">elf Pavlik</a></span>
      <dt>Version:
      <dd>0.1.0
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright">
    <p> Copyright © 2024 the Contributors to the Solid Security Considerations,
  published by the <a href="https://www.w3.org/community/solid/">Solid Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
  A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This document describes a few issues related to security in the Solid ecosystem.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This report was published by the <a href="https://www.w3.org/community/solid/">Solid Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.
  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.
  Learn more about <a href="https://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#attacks-and-mitigations"><span class="secno">1</span> <span class="content">Attacks and Mitigations</span></a>
     <ol class="toc">
      <li><a href="#solid-oidc"><span class="secno">1.1</span> <span class="content">Solid OIDC</span></a>
      <li><a href="#serving-user-created-files"><span class="secno">1.2</span> <span class="content">Serving user-created files</span></a>
      <li><a href="#protecting-webid-document"><span class="secno">1.3</span> <span class="content">Protecting WebID Document</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="attacks-and-mitigations"><span class="secno">1. </span><span class="content">Attacks and Mitigations</span><a class="self-link" href="#attacks-and-mitigations"></a></h2>
   <h3 class="heading settled" data-level="1.1" id="solid-oidc"><span class="secno">1.1. </span><span class="content">Solid OIDC</span><a class="self-link" href="#solid-oidc"></a></h3>
   <p><a data-link-type="biblio" href="#biblio-solidoidc" title="Solid OIDC">[Solid.OIDC]</a></p>
   <div class="issue no-marker" id="issue-d41d8cd9"><a class="self-link" href="#issue-d41d8cd9"></a><a class="marker" href="https://github.com/solid/security-considerations/issues/3" style="text-transform:none">solid/security-considerations/3</a><a href="https://github.com/solid/security-considerations/issues/3">Document attacks possible when WebID Document is hosted in a Solid Storage</a></div>
   <div class="issue no-marker" id="issue-d41d8cd9①"><a class="self-link" href="#issue-d41d8cd9①"></a><a class="marker" href="https://github.com/solid/security-considerations/issues/4" style="text-transform:none">solid/security-considerations/4</a><a href="https://github.com/solid/security-considerations/issues/4">Document attacks possible when hosting Soild-OIDC Provider on the same origin as storages</a></div>
   <div class="issue no-marker" id="issue-d41d8cd9②"><a class="self-link" href="#issue-d41d8cd9②"></a><a class="marker" href="https://github.com/solid/security-considerations/issues/5" style="text-transform:none">solid/security-considerations/5</a><a href="https://github.com/solid/security-considerations/issues/5">Document attacks possible when Solid-OIDC issuer is compromised</a></div>
   <div class="issue no-marker" id="issue-d41d8cd9③"><a class="self-link" href="#issue-d41d8cd9③"></a><a class="marker" href="https://github.com/solid/security-considerations/issues/6" style="text-transform:none">solid/security-considerations/6</a><a href="https://github.com/solid/security-considerations/issues/6">Document possible phishing attacks during authentication with Solid-OIDC</a></div>
   <h3 class="heading settled" data-level="1.2" id="serving-user-created-files"><span class="secno">1.2. </span><span class="content">Serving user-created files</span><a class="self-link" href="#serving-user-created-files"></a></h3>
   <p>When Solid Servers <a data-link-type="biblio" href="#biblio-solidprotocol" title="Solid Protocol">[Solid.Protocol]</a> serve files created by different users,
they break the common Web assumption that files and/or applications served
within the same origin are automatically equally trustworthy.</p>
   <p>An attacker could be any agent — human, browser, browser-based application,
etc. — with a WebID. They need append/write access to the user’s server
to store a malicious HTML file. They might have this access because the
user had allowed them to write a blog post, or because they have their own
storage in a different path on the same domain, among other possibilities.</p>
   <p>Impact of the scenario: The attacker, pretending to be the victim, can access anything
that the victim’s account can access.</p>
   <h4 class="heading settled" data-level="1.2.1" id="use-solid-oidc-dpop-bound-id-tokens-to-make-authenticated-requests"><span class="secno">1.2.1. </span><span class="content">Use Solid-OIDC DPoP-bound ID tokens to make authenticated requests</span><a class="self-link" href="#use-solid-oidc-dpop-bound-id-tokens-to-make-authenticated-requests"></a></h4>
   <p>If a user is logged in to an application hosted on the Solid server, a
malicious application on the same Solid server could abuse this login to 
make authenticated requests. Here we use <a data-link-type="biblio" href="#biblio-solidos" title="SolidOS">[SolidOS]</a> as an example of a 
benign application.</p>
   <h5 class="heading settled" data-level="1.2.1.1" id="prerequisites"><span class="secno">1.2.1.1. </span><span class="content">Prerequisites</span><a class="self-link" href="#prerequisites"></a></h5>
   <ul>
    <li data-md>
     <p>When multiple agents are allowed to perform append or write operations in a storage,
the attacker has append or write access to a publicly readable resource in a storage.</p>
    <li data-md>
     <p>The server serves <a data-link-type="biblio" href="#biblio-solidos" title="SolidOS">[SolidOS]</a> under the same domain (e.g., by default, <a data-link-type="biblio" href="#biblio-communitysolidserver" title="Community Solid Server">[Community.Solid.Server]</a> serves everything under the same domain).</p>
    <li data-md>
     <p>Once the victim is logged in via <a data-link-type="biblio" href="#biblio-solidos" title="SolidOS">[SolidOS]</a>, any new session is automatically logged
in to the same account.</p>
   </ul>
   <h5 class="heading settled" data-level="1.2.1.2" id="attack"><span class="secno">1.2.1.2. </span><span class="content">Attack</span><a class="self-link" href="#attack"></a></h5>
   <p>The attacker writes a malicious <code>text/html</code> file to the server. When this file is opened
by the user:</p>
   <ol>
    <li data-md>
     <p>It opens <a data-link-type="biblio" href="#biblio-solidos" title="SolidOS">[SolidOS]</a> in a new tab and saves the window reference. (If the writer of
this document recalls correctly, opening any non-existent resource from the server returns <a data-link-type="biblio" href="#biblio-solidos" title="SolidOS">[SolidOS]</a>.)</p>
    <li data-md>
     <p><a data-link-type="biblio" href="#biblio-solidos" title="SolidOS">[SolidOS]</a> automatically logs in, as the user who logged in there previously.</p>
    <li data-md>
     <p>The <code>text/html</code> file can access <a data-link-type="biblio" href="#biblio-solidos" title="SolidOS">[SolidOS]</a> via the window reference, including
performing authenticated fetch.</p>
    <li data-md>
     <p>The <code>text/html</code> file can make any request in the name of the currently logged-in user,
through this authenticated fetch.</p>
   </ol>
   <h4 class="heading settled" data-level="1.2.2" id="steal-login-credentials"><span class="secno">1.2.2. </span><span class="content">Steal login credentials</span><a class="self-link" href="#steal-login-credentials"></a></h4>
   <p>If a user saves credentials for an application on the same site as the Solid server,
a malicious application could steal these credentials.</p>
   <h5 class="heading settled" data-level="1.2.2.1" id="prerequisites①"><span class="secno">1.2.2.1. </span><span class="content">Prerequisites</span><a class="self-link" href="#prerequisites①"></a></h5>
   <ul>
    <li data-md>
     <p>The attacker has append/write access to a publicly readable folder/file on the server.</p>
    <li data-md>
     <p>The victim uses the IDP of the (small) <a data-link-type="biblio" href="#biblio-communitysolidserver" title="Community Solid Server">[Community.Solid.Server]</a> server.</p>
    <li data-md>
     <p>The storages are on the same domain as the IDP (default for <a data-link-type="biblio" href="#biblio-communitysolidserver" title="Community Solid Server">[Community.Solid.Server]</a>).</p>
    <li data-md>
     <p>The user saved their login credentials (<code>/idp/login/</code> for <a data-link-type="biblio" href="#biblio-communitysolidserver" title="Community Solid Server">[Community.Solid.Server]</a>)
via the browser or a password manager extension.</p>
   </ul>
   <h5 class="heading settled" data-level="1.2.2.2" id="attack①"><span class="secno">1.2.2.2. </span><span class="content">Attack</span><a class="self-link" href="#attack①"></a></h5>
   <p>The attacker writes a malicious <code>text/html</code> file to the server. Depending on the tool used
to store the login credentials, the actual autofill/suggestion behaviour can vary. For instance,
if a user who saved login credentials with Chrome opens the malicious file:</p>
   <ol>
    <li data-md>
     <p>The victim performs any interaction with the site (e.g., clicking on a cookie banner).</p>
    <li data-md>
     <p>Chrome automatically fills in <code>&lt;input></code> fields for the user name and password with the saved credentials.</p>
    <li data-md>
     <p>The malicious <code>text/html</code> file can read and send the credentials to the attacker.</p>
    <li data-md>
     <p>The attacker can use the credentials to log in with the IDP of the victim.</p>
   </ol>
   <h4 class="heading settled" data-level="1.2.3" id="serving-user-created-files-countermeasures"><span class="secno">1.2.3. </span><span class="content">Countermeasures</span><a class="self-link" href="#serving-user-created-files-countermeasures"></a></h4>
   <ul>
    <li data-md>
     <p>Multiple agents can create files on the same server, which could render <code>same-origin</code> security boundaries useless.</p>
    <li data-md>
     <p>As one possible countermeasure, servers could add a
[<code>Content-Security-Policy: sandbox</code>](https://www.w3.org/TR/CSP3/#directive-sandbox) header
to artificially enable <code>same-origin</code> security policies for files served on the same origin.</p>
   </ul>
   <h5 class="heading settled" data-level="1.2.3.1" id="considerations"><span class="secno">1.2.3.1. </span><span class="content">Considerations</span><a class="self-link" href="#considerations"></a></h5>
   <p>Servers are strongly encouraged to consider the countermeasures in the context of the use cases
they want to enable or disable on a given storage. For instance, using <code>Content-Security-Policy: sandbox</code> will universally prohibit various functionalities for
applications, including but not limited to accessing local storage, executing scripts,
using forms, interacting with plugins, or including external content. This broad range of
restrictions may not be desirable for various categories of applications that rely on
client-side storage mechanisms, collaborative features, or dynamic content interaction.</p>
   <h3 class="heading settled" data-level="1.3" id="protecting-webid-document"><span class="secno">1.3. </span><span class="content">Protecting WebID Document</span><a class="self-link" href="#protecting-webid-document"></a></h3>
   <p>Solid access policy enforcement relies heavily on the identities of agents. Requesting Parties are identified
by <a data-link-type="biblio" href="#biblio-webid" title="WebID 1.0">[WebID]</a> and applications by ClientID <a data-link-type="biblio" href="#biblio-solidoidc" title="Solid OIDC">[Solid.OIDC]</a>.
A User’s WebID Document includes trust anchors, like designation of their <a data-link-type="biblio" href="#biblio-solidoidc" title="Solid OIDC">[Solid.OIDC]</a> Provider (also known as _issuer_).
In other approaches, public keys could be published or discoverable via the user’s WebID Document.</p>
   <h4 class="heading settled" data-level="1.3.1" id="fully-impersonate-the-user"><span class="secno">1.3.1. </span><span class="content">Fully impersonate the user</span><a class="self-link" href="#fully-impersonate-the-user"></a></h4>
   <p>If a malicious app can write or append to the user’s WebID Document,
it could inject trust anchors, allowing complete impersonation.</p>
   <h5 class="heading settled" data-level="1.3.1.1" id="exploit-prerequisites"><span class="secno">1.3.1.1. </span><span class="content">Exploit Prerequisites</span><a class="self-link" href="#exploit-prerequisites"></a></h5>
   <ul>
    <li data-md>
     <p>Solid’s authorization system depends on a specific trust anchor in the user’s WebID Document.
For example, <a data-link-type="biblio" href="#biblio-solidoidc" title="Solid OIDC">[Solid.OIDC]</a> issuer designation or pubic keys/keyset.</p>
    <li data-md>
     <p>User authorizes a malicious Solid application to write or append to their WebID Document.</p>
   </ul>
   <h5 class="heading settled" data-level="1.3.1.2" id="attack②"><span class="secno">1.3.1.2. </span><span class="content">Attack</span><a class="self-link" href="#attack②"></a></h5>
   <ul>
    <li data-md>
     <p>The attacker publishes an attractive malicious application,
such as one that generates cool AI avatars and setting them in the user’s profile.</p>
    <li data-md>
     <p>User authenticates with the malicious application.</p>
    <li data-md>
     <p>If the access control system enforces client constraints,
  the user also authorizes the application to write or append to their WebID Document.</p>
    <li data-md>
     <p>Application injects attacker’s trust anchor into the user’s WebID Document.</p>
    <li data-md>
     <p>The attacker can now completely impersonate the user, with full access to all the data owned by the user,
as well as access to any data shared with that user by others, to the full extent they granted to the impersonated user.</p>
   </ul>
   <h4 class="heading settled" data-level="1.3.2" id="countermeasures"><span class="secno">1.3.2. </span><span class="content">Countermeasures</span><a class="self-link" href="#countermeasures"></a></h4>
   <div class="issue no-marker" id="issue-d41d8cd9④"><a class="self-link" href="#issue-d41d8cd9④"></a><a class="marker" href="https://github.com/solid/security-considerations/issues/9" style="text-transform:none">solid/security-considerations/9</a><a href="https://github.com/solid/security-considerations/issues/9">initial WebID Document considerations</a></div>
  </main>
  <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-communitysolidserver">[Community.Solid.Server]
   <dd>Joachim Van Herwegen. <a href="https://communitysolidserver.github.io/"><cite>Community Solid Server</cite></a>. URL: <a href="https://communitysolidserver.github.io/">https://communitysolidserver.github.io/</a>
   <dt id="biblio-solidoidc">[Solid.OIDC]
   <dd>Aaron Coburn; elf Pavlik; Dmitri Zagidulin. <a href="https://solidproject.org/TR/oidc"><cite>Solid OIDC</cite></a>. URL: <a href="https://solidproject.org/TR/oidc">https://solidproject.org/TR/oidc</a>
   <dt id="biblio-solidprotocol">[Solid.Protocol]
   <dd>Sarven Capadisli; Tim Berners-Lee; Kjetil Kjernsmo. <a href="https://solidproject.org/TR/protocol"><cite>Solid Protocol</cite></a>. URL: <a href="https://solidproject.org/TR/protocol">https://solidproject.org/TR/protocol</a>
   <dt id="biblio-solidos">[SolidOS]
   <dd>SolidOS Team. <a href="https://solidos.solidcommunity.net/"><cite>SolidOS</cite></a>. URL: <a href="https://solidos.solidcommunity.net/">https://solidos.solidcommunity.net/</a>
   <dt id="biblio-webid">[WebID]
   <dd>Andrei Sambra; Henry Story; Tim Berners-Lee. <a href="https://www.w3.org/2005/Incubator/webid/spec/identity/"><cite>WebID 1.0</cite></a>. URL: <a href="https://www.w3.org/2005/Incubator/webid/spec/identity/">https://www.w3.org/2005/Incubator/webid/spec/identity/</a>
  </dl>